/*! real-media-library 22-08-2017 */

"use strict";!function(e){Function.prototype.bind=function(){}.bind||function(e){function t(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var i=[].slice,n=i.call(arguments,1),o=this,a=function(){return o.apply(this instanceof t?this:e||window,n.concat(i.call(arguments)))};return t.prototype=this.prototype,a.prototype=new t,a},Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var i=t||0,n=this.length;i<n;i++)if(this[i]===e)return i;return-1}),e.mjs&&e.mjs.nestedSortable&&e.widget("mguenter.nestedSortable",e.extend({},e.mjs.nestedSortable.prototype,{_mouseDrag:function(t){if(e.mjs.nestedSortable.prototype._mouseDrag.apply(this,arguments),e(t.srcElement).parents(".aio-nodes").size()>0){var i,n,o,a,s,r,l=t.clientX,d=t.clientY,c=!1;for(n=this.items.length-1;n>=0;n--)o=(i=this.items[n]).left,a=i.top,s=o+i.width,r=a+i.height,l>=o&&l<=s&&d>=a&&d<=r&&!this.currentContainer.currentItem.is(i.item)&&(t.hoverListElement=i.item,this._trigger("hoverListElement",t,this._uiHash()),c=!0);c||this._trigger("noHoverListElement",t,this._uiHash())}}})),e(document).on("click focus",'.aio-tree [disabled="disabled"]',function(t){return t.preventDefault(),e(document.activeElement).blur(),!1});var t=function(e){this._usedOpposite=null,this._usedCollapsable=!1,this._useCollapsableLocalStorage=!1,this.init(e)};t.prototype.init=function(t){!t._generatedId&&t.options.container.isCollapsable?this._doCollapsable(t):t._nodes.find("li").addClass("aio-open"),this._doResizable(t),e(document).on("click","."+t._eventClassId+" .aio-list-standard a",function(i){if("function"==typeof t.options.others.onSwitchFolder&&!e(this).hasClass("aio-disable-link"))return t.options.others.onSwitchFolder.bind(t.element)(e(this),i)})},t.prototype.sticky=function(t){if(t.options.container.isSticky){if(void 0===e.fn.hcSticky)throw"If want to use the sticky container please include the HC Sticky jQuery plugin, see http://someweblog.com/hcsticky-jquery-floating-sticky-plugin/ !";if(t.element.data("sticky"))return void t.element.hcSticky("reinit");t.element.hcSticky(t.options.container.hcStickySettings),t.element.data("sticky",!0)}},t.prototype._doTooltips=function(t){var i=t.options.container.onDoTooltips;if("function"==typeof i)i.bind(t)();else{if("function"!=typeof e.fn.tooltipster)throw"Please include tooltipster jQuery plugin (http://iamceege.github.io/tooltipster/)";var n,o,a,s;e(".aio-tooltip").each(function(){if(n=e(this).attr("data-aio-tooltip-title"),o=e(this).attr("data-aio-tooltip-text"),a=e(this).attr("data-aio-tooltip-text-disabled"),e(this).hasClass("aio-disable-link")&&(o=a),n.length>0||o.length>0){if(s=(n.length>0?'<div class="aio-tooltip-title">'+n+"</div>":"")+'<div class="aio-tooltip-text">'+o+"</p>",e(this).hasClass("tooltipstered"))try{e(this).tooltipster("destroy")}catch(e){}e(this).tooltipster(e.extend({content:s,contentAsHTML:!0,theme:"tooltipster-aio",animation:"grow",maxWidth:225},t.options.container.tooltipsterSettings))}})}},t.prototype._doCollapsable=function(t){this._usedCollapsable=!0,this._useCollapsableLocalStorage=t._localStorage&&t.options.container.collapsableLocalstorage,this._updateCollapsableNodes(t);var i=this._useCollapsableLocalStorage;e(document).on("dblclick","."+t._eventClassId+" a",function(){var t=e(this).parent().children(".aio-expander");t.is(":visible")&&t.click()}),e(document).on("click","."+t._eventClassId+" .aio-expander",function(){var n=e(this).hasClass("aio-open"),o=n?"aio-open":"aio-close",a=n?"aio-close":"aio-open",s="aio-open"==a?"1":"0";e(this).removeClass(o).addClass(a),e(this).parent().removeClass(o).addClass(a);var r=e(this).parent().children("a");if("function"==typeof t.options.others.onExpand&&t.options.others.onExpand.bind(t.element)(s,e(this).parent().children("a")),i&&t._hasAttr("data-aio-id",r)){var l=r.attr("data-aio-id");window.localStorage.setItem("AIO"+t._id+"-expand-"+l,s)}})},t.prototype._updateCollapsableNodes=function(t){if(!0!==this._usedCollapsable)return!1;var i,n,o,a,s,r=this._useCollapsableLocalStorage;return t._nodes.find(".aio-expander").remove(),t._nodes.find("li").each(function(){e(this).children("ul").children("li").size()>0&&(o=void 0,n="aio-close",a=e(this).children("a"),r&&t._hasAttr("data-aio-id",a)&&(s=a.attr("data-aio-id"),"1"==(o=window.localStorage.getItem("AIO"+t._id+"-expand-"+s))?n="aio-open":"0"==o&&(o="aio-close")),t._defined(o)||(n="aio-"+t.options.container.collapsableDefaultStatus),e(this).addClass(n),i=e('<div class="aio-expander '+n+'"><i class="fa fa-minus-square-o"></i><i class="fa fa-plus-square-o"></i></div>').appendTo(e(this)))}),!0},t.prototype._doResizable=function(t){var i=t._isTouch(),n=t.options.container,o=function(){var e=t.element.width();return e<t.options.container.resizeMin&&(e=t.options.container.resizeMin),e>t.options.container.resizeMax?t.options.container.resizeMax:e},a=e('<div class="aio-split-resize"></div>').prependTo(t.element.children(".aio-wrap"));(t._generatedId||!t.options.container.isResizable||!t._localStorage&&0!=t.options.container.resizeLocalStorage||!n.resizeTouch&&i.touch)&&a.addClass("aio-hide");var s=0;n.resizeLocalStorage&&t._localStorage&&(s=window.localStorage.getItem("AIO"+t._id+"-width"),t._defined(s)||(s=n.defaultWidth)),s<n.resizeMin&&(s=n.resizeMin);var r=null;if("function"==typeof n.onResizeOpposite)r=n.onResizeOpposite;else{var l=t._parseElements(n.resizeOpposite);if(a.hasClass("aio-hide"))r=function(){};else{if(!t._defined(l)||0==l.size())throw"If you want to resize the container, you need an opposite site! (options.container.resizeOpposite)";l=l.first(),this._usedOpposite=l;var d=t._idGenerate(l);r=function(e){if(n.resizeOppositeMin>0&&l.width()<n.resizeOppositeMin+1)return!1;try{t._injectStyle("opposite","#"+d+"{width: -webkit-calc(100% - "+e+"px) !important;width: -moz-calc(100% - "+e+"px) !important;width: calc(100% - "+e+"px) !important;}")}catch(e){return!1}}}}if(null===r)throw"There is no opposite handler!";var c=0,h=t.element,p="function"==typeof n.customResizeHandler?n.customResizeHandler:function(e){e.preventDefault();var t=n.resizeMin,i=n.resizeMax,o=e.pageX-h.offset().left;o>=t&&o<=i&&!1!==r(c=o)&&(h.css("width",c+"px"),h.data("sticky")&&h.parent().css("width",c+"px"))};p=p.bind(t.element),r=r.bind(t.element);var u=!1;a.on(i.down,function(t){t.preventDefault(),e(document).on(i.move,p),u=!0}),e(document).on(i.up,function(a){a.preventDefault(),e(document).unbind(i.move,p),u&&(n.resizeLocalStorage&&t._localStorage&&window.localStorage.setItem("AIO"+t._id+"-width",o()),"function"==typeof n.onResizeFinished&&n.onResizeFinished.bind(t.element)(t.element.width())),u=!1});var f="function"==typeof n.onResizeInit?n.onResizeInit:function(e){h.css("width",e+"px")};f=f.bind(t.element),!1!==r(s)&&f(s),a.show()};var i=function(e){this.currentState=!0,this.currentStateText="enable",this.init(e)};i.prototype.init=function(e){this._doDraggable(e.options.movement,e),this._doDroppable(e.options.movement,e)},i.prototype.reinit=function(e){this._doDraggable(e.options.movement,e),this._doDroppable(e.options.movement,e)},i.prototype.state=function(e,t){this.currentState=t,this.currentStateText=t?"enable":"disable",this.reinit(e)},i.prototype._doDraggable=function(t,i){var n="function"==typeof t.onGetLabel?t.onGetLabel:this.draggableLabel,o="function"==typeof t.onGetHelper?t.onGetHelper:this.draggableHelper;n=n.bind(i.element),o=o.bind(i.element);var a={revert:"invalid",appendTo:"body",cursorAt:{top:0,left:0},distance:10,scrollSensitivity:50,scrollSpeed:50,refreshPositions:!0,helper:function(){var e=n(this,arguments);return o(e,this,arguments)},start:function(e){i._standardList.addClass("aio-currently-dragging"),jQuery(document.activeElement).blur()},stop:function(){i._standardList.removeClass("aio-currently-dragging")}};e.extend(a,t.draggableSettings),e(t.selector).draggable(a).draggable(this.currentStateText)},i.prototype._doDroppable=function(t,i){i._standardList.find("a").droppable(e.extend({activeClass:"ui-state-default",hoverClass:"ui-state-hover",tolerance:"pointer"},t.droppableSettings)).droppable(this.currentStateText)},i.prototype.draggableLabel=function(){return'<i class="fa fa-arrow-right" style="margin-right:5px;"></i> Move'},i.prototype.draggableHelper=function(t){return e('<div class="aio-movement-helper">'+t+"</div>")};var n=function(e){this.container=null,this.init(e)};n.prototype.init=function(t){this.container=e('<div class="aio-tree-loader"></div>').appendTo(t._toolbar)},n.prototype.fromArguments=function(e){if(0===e.length)return this.container.width()>0;var t;1===e.length?t="show"==e[0]||1==e[0]?100:"hide"==e[0]||0==e[1]?0:e[0]:2===e.length&&(t=e[0]/e[1]*100),this.change(t)},n.prototype.change=function(e){e>0?(this.container.parents(".aio-tree").addClass("loading"),this.container.css("width",e+"%")):(this.container.parents(".aio-tree").removeClass("loading"),this.container.css("width","0px"))};var o=function(e){this.itemsContainer=null,this.widget=null,this._rearrangeInvokeSimulate=null,this.init(e)};o.prototype.init=function(e){this.widget=e,this.itemsContainer=e._toolbar.find(".aio-toolbar-items"),this._iterateButtons(e,function(t){this._doCreateLink(t,e)}.bind(this))},o.prototype._doCreateLink=function(t,i){if(!(this.itemsContainer.find('a[data-aio-name="'+t.name+'"]').size()>0)){var n="string"==typeof t.cssClasses?t.cssClasses:"";n+="string"==typeof t.usePredefinedFunction?" aio-predefined-"+t.usePredefinedFunction:"";var o=t.labelBack||i.options.toolbarButtons.labelBack,a="object"==typeof t.visibleInActiveFolderType&&t.visibleInActiveFolderType.length>0?t.visibleInActiveFolderType.join(";"):":",s='<a href="#" class="'+n+' aio-tooltip" style="display:none;" data-aio-predisable="'+("function"==typeof t.onPreDisable?"toolbar":"")+'" data-aio-name="'+t.name+'" data-aio-allowed="'+a+'" data-aio-name="'+t.name+'" data-aio-tooltip-title="'+(void 0!==t.toolTipTitle?t.toolTipTitle:"")+'" data-aio-tooltip-text-disabled="'+(void 0!==t.toolTipTextDisabledLink?t.toolTipTextDisabledLink:"")+'" data-aio-tooltip-text="'+(void 0!==t.toolTipText?t.toolTipText:"")+'">'+t.content+'<span class="aio-toolbar-back">'+o+"</span></a>",r=e(s).appendTo(this.itemsContainer),l="string"==typeof t.usePredefinedFunction&&"function"==typeof this["_doPredefined"+t.usePredefinedFunction],d=l&&"function"==typeof this["_doPredefinedInit"+t.usePredefinedFunction];t.element=r,r.data("aio-link",t),d&&this["_doPredefinedInit"+t.usePredefinedFunction](i,e(this),t);var c=this;r.click(function(n){var o=i.active(),a=e(this).hasClass("isCancelActive"),s=o.size()>0&&"AIO_NEW_TO_CREATE"==o.attr("data-aio-id"),r=!1;if("function"==typeof t.onAllowed&&!a&&!1===t.onAllowed.bind(i.element)(i,e(this)))return n.preventDefault(),!1;if(e(this).hasClass("aio-disable-link")&&!s)return n.preventDefault(),!1;if(s)if(a){i.element.removeClass("aio-prepare-create-new");var d=i._typesHandler._activeBeforeCreateForm;null!=d&&"object"==typeof d&&(r=d),i._typesHandler._activeBeforeCreateForm=null}else i.element.addClass("aio-prepare-create-new");return l&&(c["_doPredefined"+t.usePredefinedFunction](i,e(this),a,t),i._typesHandler.state(a)),"function"==typeof t.onCancel&&(a?(c.itemsContainer.add(e(this)).removeClass("isCancelActive"),t.onCancel.bind(i.element)(e(this))):c.itemsContainer.add(e(this)).addClass("isCancelActive"),i._typesHandler.state(a)),"function"!=typeof t.onClick||a||t.onClick.bind(i.element)(i,e(this)),i._defined(r)&&i.active(r),n.preventDefault(),!1})}},o.prototype._doPredefinedInitrename=function(t,i,n){e(document).on("keydown","."+t._eventClassId+" a",function(e){if(113==e.which)return n.element.click(),!1})},o.prototype._doPredefinedInitrearrange=function(t,i,n){if(t.options.container.doNotUseSaveInRearrange){var o=this;e(document).on("dragstart","."+t._eventClassId+" a[data-aio-id]",function(i){if(!e(this).parents(".aio-tree").hasClass("aio-rearrange"))return o._rearrangeInvokeSimulate=[e(this),i],t.toolbarButton("rearrange"),i.preventDefault(),!1})}},o.prototype._doPredefinedrename=function(t,i,n,o){var a,s,r=t.active(),l=arguments,d=r.find(".aio-node-name"),c=r.size()>0&&"AIO_NEW_TO_CREATE"==r.attr("data-aio-id"),h=function(){this._doPredefinedrename.apply(this,l)}.bind(this),p=function(){var e=a.val(),i=c?t.options.others.onCreateFolder:o.onSave;if("function"!=typeof i)throw"If you want to use the rename/create function please define an onSave/onCreateFolder action!";i=i.bind(t.element),c?i(e,r.data("createType"),r.data("createToParent"),r):i(r.attr("data-aio-id"),e)}.bind(t);"hidden"!==d.css("visibility")?(d.css("visibility","hidden"),t.nodes(!1),this.itemsContainer.add(i).addClass("isCancelActive"),a=e('<input type="text"/>').insertAfter(r),s=e('<button class="aio-rename-submit">'+t.options.others.labelRenameSave+"</button>").insertAfter(a),a.val(d.html()).focus(),a.keypress(function(e){13==e.which&&p()}).keyup(function(e){27==e.which&&h()}),s.on("click",function(e){return p(),e.preventDefault(),!1})):(d.css("visibility","visible"),t.nodes(!0),this.itemsContainer.add(i).removeClass("isCancelActive"),r.parent().children("input,button.aio-rename-submit").remove())},o.prototype._doPredefinedrearrange=function(t,i,n){if("function"!=typeof e.fn.nestedSortable)throw"Please include nestedSortable jQuery plugin (https://github.com/ilikenwf/nestedSortable)";var o=t._nodes.children("ul"),a=t.element.find(".aio-rearrange-save"),s=t.options.container.onRearrangeSave,r=t.options.container.onRearrangeCancel;if(n){if(i&&this.itemsContainer.add(i).removeClass("isCancelActive"),t._standardList.children("a").attr("disabled",!1),t._standardList.children(".aio-search").attr("disabled",!1),t.element.removeClass("aio-rearrange"),o.nestedSortable("destroy"),o.data("nestedSortable",!1),a.stop().hide(),!t.options.container.doNotUseSaveInRearrange){var l=o.data("nodesHTML");o.html(l)}t.nodes(!0),t.movement(!0),"function"==typeof r&&r.bind(t.element)(t,event)}else{if(t.element.addClass("aio-rearrange"),i&&this.itemsContainer.add(i).addClass("isCancelActive"),t._standardList.children("a").attr("disabled","disabled"),t._standardList.children(".aio-search").attr("disabled","disabled"),o.data("nodesHTML",o.html()),!t.options.container.doNotUseSaveInRearrange){if(a.size()<=0){var d=this;(a=e('<button class="aio-rearrange-save button button-primary" style="display:none;">'+t.options.others.labelRearrangeSave+"</button>").insertAfter(t._toolbar)).click(function(i){return"function"==typeof s&&s.bind(t.element)(d._doPredefinedrearrangeParse(t,o),o.html(),e(this),i),i.preventDefault(),!1})}a.show()}t.movement(!1),t.nodes(!1),this._doPredefinedrearrangeActivate(o,t),o.data("nestedSortable",!0)}},o.prototype._doPredefinedrearrangeActivate=function(t,i){try{t.nestedSortable("destroy")}catch(i){}var n,o,a=this._rearrangeInvokeSimulate,s=t.scrollParent();if(s=s.is(document)?"parent":s,t.nestedSortable(e.extend({handle:"a[data-aio-href]",items:"li",listType:"ul",tolerance:"intersect",toleranceElement:"> a",helper:"clone",forceHelperSize:!1,forcePlaceholderSize:!0,doNotClear:!0,hoverListElement:function(e,i){var a=e.hoverListElement;if(!a.is(o)){o=a,clearTimeout(n);var s=a.children(".aio-expander");1!==s.size()||s.hasClass("aio-open")||(n=setTimeout(function(){s.click(),setTimeout(function(){t.nestedSortable("refreshPositions")},50)},700))}},noHoverListElement:function(){clearTimeout(n),o=null},sort:function(e,i){i.helper.data("refreshPositions")||(t.nestedSortable("refreshPositions"),i.helper.data("refreshPositions",!0))},start:function(e,n){i.options.container.doNotUseSaveInRearrange&&n.item.data("oldNodesHTML",t.data("nodesHTML"))},relocate:function(t,n){i.reinit("tree");var o=e.makeArray(arguments),a=i.options.container.doNotUseSaveInRearrange,s=i.options.container.onRearrangeRelocate;if(a){if("function"!=typeof s)throw"Please define the onRearrangeRelocate function in the options!";var r,l,d,c,h=e.Deferred(),p=n.item,u=p.next(),f=p.prev(),v=!!u.is("li")&&u.children("a").attr("data-aio-id"),m=!!f.is("li")&&f.children("a").attr("data-aio-id"),_=-1,b=i._nodes.find("a[data-aio-id]"),y=p.data("oldNodesHTML"),g=p.children("a").attr("data-aio-id"),C=p.parent().parent().children("a[data-aio-id]"),w=C.size()>0?C.attr("data-aio-id"):i.options.others.rootParentId;i.loader(!0),b.each(function(){if(_++,e(this).attr("data-aio-id")===g)return!1}),d=!!(r=b.eq(_+1)).is("a")&&r.attr("data-aio-id"),c=_-1>=0&&(!!(l=b.eq(_-1)).is("a")&&l.attr("data-aio-id")),s.apply(i.element,[g,w,h,m,v,c,d,o]),h.then(function(){}.bind(this),function(){i.nodesHTML(y)}.bind(this)).always(function(){i.loader(!1)}.bind(this))}},isAllowed:function(e,t,n){if(i.loader())return!1;var o=!0;if(n.parents(".aio-restrict-hierarchical-change").size()>0){var a=n.attr("id");0===e.parent().children("#"+a).size()&&(o=!1)}return e.parents(".aio-restrict-hierarchical-change").size()>0&&(o=!1),o},stop:function(){a&&i.toolbarButton("rearrange"),this._rearrangeInvokeSimulate=null}.bind(this)},i.options.container.nestedSortableSettings)),a&&dispatchEvent){var r=a[0][0],l=a[1],d=l.clientX,c=l.clientY;this._dispatchEvent(r,"mousedown",this._createRearrangeEvent("mousedown",r,{clientX:d,clientY:c})),this._dispatchEvent(document,"mousemove",this._createRearrangeEvent("mousemove",document,{clientX:d+1,clientY:c+1}))}},o.prototype._dispatchEvent=function(e,t,i){return e.dispatchEvent?e.dispatchEvent(i):e.fireEvent&&e.fireEvent("on"+t,i),i},o.prototype._createRearrangeEvent=function(t,i,n){var o,a=e.extend({target:i,preventDefault:function(){},stopImmediatePropagation:function(){},stopPropagation:function(){},isPropagationStopped:function(){return!0},isImmediatePropagationStopped:function(){return!0},isDefaultPrevented:function(){return!0},bubbles:!0,cancelable:"mousemove"!=t,view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},n||{});return e.isFunction(document.createEvent)?(o=document.createEvent("MouseEvents")).initMouseEvent(t,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget||document.body.parentNode):document.createEventObject&&(o=document.createEventObject(),e.extend(o,a),o.button={0:1,1:4,2:2}[o.button]||o.button),o},o.prototype._doPredefinedrearrangeParse=function(t,i){var n=i.nestedSortable("toArray",{startDepthCount:0,onGetId:function(e,t,i,n){return e.children("a").attr("data-aio-id")}});n.shift();var o=[];return"object"==typeof n&&n.length>1&&e.each(n,function(e,i){null==i.parent_id&&(i.parent_id=t.options.others.rootParentId),o.push({fid:i.id,pid:i.parent_id})}),{raw:n,parsed:o}},o.prototype._iterateButtons=function(e,t){var i=e.options.toolbarButtons.items;if("object"==typeof i||i.length>0)for(var n,o,a=0;a<i.length;a++)if(n=i[a],o=n.name,e._defined(o)){if(!1===t(n,e))break}else console.error("Toolbar button must have a name.")};var a=function(e){this._linkContainer=!1,this._animationTimeout=void 0,this._activeBeforeCreateForm=null,this.init(e)};a.prototype.init=function(t){if(this._iterateCreateTypes(t,function(e){this._doCreateLink(e,t)}.bind(this)),0!=this._linkContainer){var i='<a href="javascript:void();" class="'+t.options.createCancel.cssClasses+' aio-cancel-create-new">'+t.options.createCancel.label+"</a>",n=e(i).appendTo(this._linkContainer);n.click(function(e){return t.toolbarButton("rename"),t._nodes.find(".aio-create-new").parent().remove(),"function"==typeof t.options.others.onTypeButtonClicked&&t.options.others.onTypeButtonClicked.bind(t.element)(n,e),e.preventDefault(),!1})}},a.prototype.state=function(e){"object"==typeof this._linkContainer&&(e?this._linkContainer.removeClass("aio-disable-all"):this._linkContainer.addClass("aio-disable-all"))},a.prototype._doCreateLink=function(t,i){var n=i.element.find(".aio-tree-headline");if(this._linkContainer=n,!(n.find('a[data-aio-name="'+t.name+'"]').size()>0)){var o="string"==typeof t.cssClasses?t.cssClasses:"",a="object"==typeof t.visibleInActiveFolderType&&t.visibleInActiveFolderType.length>0?t.visibleInActiveFolderType.join(";"):":",s="function"==typeof t.onPreDisable?"type":"",r='<a href="#" class="'+o+' aio-tooltip" style="display:none;" data-aio-name="'+t.name+'" data-aio-predisable="'+s+'" data-aio-allowed="'+a+'" data-aio-tooltip-title="'+(void 0!==t.toolTipTitle?t.toolTipTitle:"")+'" data-aio-tooltip-text="'+(void 0!==t.toolTipText?t.toolTipText:"")+'">'+t.label+"</a>",l=e(r).appendTo(n);l.data("createType",t),l.click(function(n){return e(this).hasClass("aio-disable-link")?(n.preventDefault(),!1):(this._doCreateForm(e(this),i,t),"function"==typeof i.options.others.onTypeButtonClicked&&i.options.others.onTypeButtonClicked.bind(i.element)(l,n),n.preventDefault(),!1)}.bind(this)),l.data("aio-link",t)}},a.prototype._doCreateForm=function(t,i,n){var o,a=i.active(),s=i.options.others.rootParentId;if(a.size()<=0||a.parents(".aio-nodes").size()<=0)o=i._nodes.children("ul");else{o=a.parent().children("ul"),s=a.attr("data-aio-id");var r=a.parent().children(".aio-expander");r.size()>0?r.hasClass("aio-close")&&r.click():a.parent().addClass("aio-open")}a.size()>0&&(this._activeBeforeCreateForm=a);var l=e('<li>            <a href="javascript:void(0)" class="aio-create-new" data-aio-type="" data-aio-id="AIO_NEW_TO_CREATE" data-aio-href="">        \t\t'+n.icon+'        \t\t<div class="aio-node-name"></div>        \t\t<span class="aio-cnt aio-cnt-0">0</span>        \t</a>        \t<ul></ul>        </li>').appendTo(o);l.children("a").data("createType",n),l.children("a").data("createToParent",s),i.active("AIO_NEW_TO_CREATE"),i.toolbarButton("rename")},a.prototype._iterateCreateTypes=function(e,t){var i=e.options.createTypes;if("object"==typeof i||i.length>0)for(var n,o,a=0;a<i.length;a++)o=(n=i[a]).name,e._defined(o)?t(n,e):console.error("Create type must have a name.")},a.prototype._doSwitchFolder=function(t,i,n){var o,a,s,r=i.attr("data-aio-type"),l={show:[],hide:[]};n||(n=300);var d="object"==typeof this._linkContainer&&this._linkContainer.find("a");(d=t._toolbar.find(".aio-toolbar-items").find("a").add(d)).each(function(){if(e(this).hasClass("aio-cancel-create-new"))return!0;(s=e(this).attr("data-aio-predisable")).length>0?("toolbar"===s?t._toolbarHandler._iterateButtons:t._typesHandler._iterateCreateTypes)(t,function(i){e(this).attr("data-aio-name")===i.name&&"function"==typeof i.onPreDisable&&(a=i.onPreDisable.bind(t.element)(i))}.bind(this)):(o=e(this).attr("data-aio-allowed"),o=":"===o?[]:o.split(";"),a=!1,o.length>0?o.indexOf(r)>-1&&(a=!0):a=!0),l[a?"show":"hide"].push(e(this))});var c,h=function(){if(l.show.length>0)for(var e=0;e<l.show.length;e++)(c=l.show[e].stop()).parent().hasClass("aio-toolbar-items")?c.removeClass("aio-disable-link"):l.show[e].stop().fadeIn(n).removeClass("aio-hidden");t.reinit("tooltips")}.bind(this);if(l.hide.length>0){for(var p=0;p<l.hide.length;p++)(c=l.hide[p].stop()).parent().hasClass("aio-toolbar-items")?c.addClass("aio-disable-link"):c.fadeOut(n).addClass("aio-hidden");t._defined(this._animationTimeout)&&clearTimeout(this._animationTimeout),this._animationTimeout=setTimeout(function(){h()}.bind(this),n>0?n+50:0)}else h()};var s=function(e){this._fixRestoreContent=!1,this._restoreContent=void 0,this._oldSelectedId=void 0,this._searchTimeout=void 0,this._noSearchResults=void 0,this._treeHeadline=void 0,this.init(e)};s.prototype.init=function(t){var i=this;this._noSearchResults=e("."+t._eventClassId+" .aio-no-results"),this._treeHeadline=e("."+t._eventClassId+" .aio-tree-headline"),e("."+t._eventClassId+" .aio-search input").on("propertychange input",function(n){("propertychange"===n.type&&"value"===n.originalEvent.propertyName||"propertychange"!==n.type)&&i._doSearch(t,e(this),n.target.value.toLowerCase())}),e(document).on("click","."+t._eventClassId+" .aio-search .fa-close",function(t){e(this).parent().children("input").val("").trigger("input")}),e(document).on("click","."+t._eventClassId+" .aio-search",function(t){e(t.target).is("input")||e(t.target).hasClass("fa-close")||e(this).children("input").focus()}),e(document).on("focus","."+t._eventClassId+" .aio-search input",function(t){e(this).parent().addClass("aio-search-focus")}),e(document).on("blur","."+t._eventClassId+" .aio-search input",function(n){e(this).parent().removeClass("aio-search-focus"),t._nodes.find(".aio-search-selected").removeClass("aio-search-selected"),i._fixRestoreContent=!!e(this).val()}),e(document).on("keydown","."+t._eventClassId+" .aio-search input",function(i){var n=t._nodes.find(".aio-search-selected");if((40===i.which||38===i.which)&&e(this).val()){var o,a=38===i.which?"prev":"next";return n.size()>0?(o=n.parent()[a]().children("a"),n.removeClass("aio-search-selected")):(a=38===i.which?"last":"first",o=t._nodes.find("a[data-aio-id]:"+a)),o.addClass("aio-search-selected"),o.size()>0&&t.nodeToViewPort(o),i.preventDefault(),!1}if(13===i.which&&n.size()>0)n[0].click();else if(27===i.which)return e(this).parent().children(".fa-close").click(),i.preventDefault(),!1;return!0})},s.prototype._doRestoreContent=function(e){if(this._restoreContent){var t=this._restoreContent.wrap("<p/>").parent(),i=e.active().attr("data-aio-id");void 0!==this._oldSelectedId&&i!=this._oldSelectedId||(i=!1),e._nodes.html(t.html()).css("min-height",""),e.element.removeClass("aio-searching"),this._restoreContent=void 0,this._oldSelectedId=void 0,this._noSearchResults.hide(),this._treeHeadline.removeClass("aio-disable-all"),e.reinit(),e.active(i,!0,!0)}},s.prototype._doFixRestoreContent=function(t,i){if(t._nodes.find(".aio-search-selected").removeClass("aio-search-selected"),this._fixRestoreContent&&this._restoreContent){var n=this;t._nodes.find("a[data-aio-id]").each(function(){n._restoreContent.find('a[data-aio-id="'+e(this).attr("data-aio-id")+'"]').replaceWith(e(this).clone().wrap("<p/>").parent().html())})}this._fixRestoreContent=!1},s.prototype._doSearch=function(t,i,n){var o=i.parent().children("i"),a=+n.length,s=n.length>0;o.eq(a).show(),o.eq(+!a).hide(),this._doFixRestoreContent(t,s),s?(void 0===this._restoreContent&&(this._restoreContent=e(t._nodes.html()),this._oldSelectedId=t.active().attr("data-aio-id"),t._nodes.css("min-height",t._nodes.height())),this._treeHeadline.addClass("aio-disable-all"),t._nodes.html(""),t.element.addClass("aio-searching"),clearTimeout(this._searchTimeout),this._searchTimeout=setTimeout(function(){if(i.val()){var o=[];this._restoreContent.find("a[data-aio-id] .aio-node-name").slice(0,20).each(function(){e(this).html().toLowerCase().indexOf(n)>-1&&o.push("<li>"+e(this).parent().clone().wrap("<p/>").parent().html()+"</li>")}),t._nodes.html("<ul>"+o.join("")+"</ul>"),o.length>0?this._noSearchResults.hide():this._noSearchResults.show(),t.reinit()}else this._doRestoreContent(t)}.bind(this),n.length>1?500:0)):this._doRestoreContent(t)};var r={options:{container:{isCollapsable:!0,isResizable:!0,isSticky:!0,theme:"",collapsableLocalstorage:!0,collapsableDefaultStatus:"open",defaultWidth:250,resizeOpposite:null,customResizeHandler:!1,onResizeOpposite:!1,onResizeInit:!1,onResizeFinished:!1,resizeTouch:!1,resizeLocalStorage:!0,resizeMin:250,resizeMax:800,resizeOppositeMin:200,onRearrangeCancel:!1,onRearrangeRelocate:!1,onRearrangeSave:!1,doNotUseSaveInRearrange:!1,onDoTooltips:!1,tooltipsterSettings:{},nestedSortableSettings:{},hcStickySettings:{},customLoaderHandler:!1},createTypes:[{name:"folder",icon:'<i class="fa fa-folder-open"></i><i class="fa fa-folder"></i>',visibleInActiveFolderType:!1,onPreDisable:!1,label:"New",cssClasses:!1,toolTipTitle:"",toolTipText:""}],createCancel:{label:"Cancel",cssClasses:""},toolbarButtons:{items:[{name:"rename",content:'<i class="fa fa-pencil"></i>',visibleInActiveFolderType:!1,usePredefinedFunction:"rename",toolTipTitle:"Rename",toolTipText:"Rename the current selected folder.",toolTipTextDisabledLink:"This link is disabled! Please select a folder."},{name:"rearrange",content:'<i class="fa fa-sort"></i>',cssClasses:!1,visibleInActiveFolderType:!1,onPreDisable:!1,onClick:!1,onCancel:!1,onAllowed:!1,usePredefinedFunction:"rearrange",toolTipTitle:"Rearrange",toolTipText:"Change the hierarchical order of the folders."}],labelBack:"Cancel"},movement:{customMovementHandler:!1,selector:".aio-draggable-item",onDrop:!1,onGetLabel:!1,onGetHelper:!1,draggableSettings:{},droppableSettings:{}},extendedMode:{enabled:!1,onCreateTemplate:!1},others:{rootParentId:-1,labelRenameSave:"OK",labelRearrangeSave:"Save new order",onExpand:!1,onAfterFinish:!1,onSwitchFolder:!1,onCreateFolder:!1,onTypeButtonClicked:!1}},_id:"",_eventClassId:"",_generatedId:!1,_localStorage:!1,_movementHandler:null,_typesHandler:null,_containerHandler:null,_loaderHandler:null,_toolbarHandler:null,_searchHandler:null,_standardList:null,_nodes:null,_toolbar:null,_create:function(){if(!this.element.hasClass("aio-tree"))throw"Add class .aio-tree to the item.";if(this._standardList=this.element.find(".aio-list-standard"),1!==this._standardList.size())throw"Please define one .aio-standard-list container";if(this._nodes=this.element.find(".aio-list-standard .aio-nodes"),1!==this._standardList.size())throw"Please define one .aio-list-standard > .aio-nodes container";if(this._toolbar=this.element.find(".aio-toolbar"),1!==this._toolbar.size())throw"Please define one .aio-toolbar container. If you want to hide the toolbar, create one and hide it with display:none;.";if("function"!=typeof e.fn.draggable||"function"!=typeof e.fn.sortable)throw"Please include jQuery UI with draggable and sortable support (https://jqueryui.com/).";this._eventClassId=this._guid(),this.element.addClass("aio-tree-instance "+this._eventClassId);var r=this.options.container.theme,l=[];if(this._defined(r)&&r.length>0){for(var d=r.split(" "),c=0;c<d.length;c++)l.push("aio-theme-"+d[c]);this.element.addClass(l.join(" "))}else this.element.addClass("aio-theme-default");this._idGenerate(),this._testLocalStorage(),this._containerHandler=new t(this),this._searchHandler=new s(this),this._typesHandler=new a(this),"object"==typeof this.options.movement.customMovementHandler?this._movementHandler=new this.options.customMovementHandler(this,i):this._movementHandler=new i(this),this._toolbarHandler=new o(this),"object"==typeof this.options.container.customLoaderHandler?this._loaderHandler=new this.options.container.customLoaderHandler(this):this._loaderHandler=new n(this);var h=this.active();h.size()>0&&this._typesHandler._doSwitchFolder(this,h,0),this._containerHandler._doTooltips(this),setTimeout(function(){this.element.removeClass("aio-tree-fade")}.bind(this),50),"function"==typeof this.options.others.onAfterFinish&&this.options.others.onAfterFinish.bind(this.element)(),this._containerHandler.sticky(this),this.element.data("allInOneTree",!0),this._checkFolderContent(),this.element.hasClass("aio-lazy")&&this.loader(!0)},nodesJSON:function(e,t){this.nodesHTML("",t)},_onCreateTemplate:function(){},reinit:function(e){var t=0==arguments.length?["movement","tooltips","tree","rearrange"]:e.split(" ");t.indexOf("movement")>-1&&this._movementHandler.reinit(this),t.indexOf("tooltips")>-1&&this._containerHandler._doTooltips(this),t.indexOf("tree")>-1&&this._containerHandler._updateCollapsableNodes(this),t.indexOf("rearrange")>-1&&this._nodes.children("ul").data("nestedSortable")&&this._toolbarHandler._doPredefinedrearrange(this,void 0,!1),this._containerHandler.sticky(this),this._checkFolderContent(),this.nodes(this._nodesLastEnabled)},movement:function(e){this._movementHandler.state(this,e)},nodeToViewPort:function(t){if(jQuery.fn.scrollParent){var i=t.scrollParent(),n=i.is(document)?e("html,body"):i,o=(i=i.is(document)?e(window):i).scrollTop(),a=this.element.find(".aio-reached-overflow"),s=parseInt(a.css("top")||0),r=o+(+a.outerHeight()+s),l=o+i.height(),d=t.offset().top+t.outerHeight(),c=l>=d;if(!(r<=d&&c)){var h=2*t.outerHeight();n.stop().animate({scrollTop:c?o-h:o+h})}}else console.warn("jQuery UI is not available (jQuery.scrollParent)")},toolbarButton:function(e){if("cancel"===e){var t=this._toolbar.find("a.isCancelActive");1===t.size()&&this.toolbarButton(t.attr("data-aio-name"))}else this._toolbarHandler._iterateButtons(this,function(t){if(t.name===e)return"object"==typeof t.element&&t.element.click(),!1}.bind(this))},active:function(e,t,i){var n=this._standardList.find("a.active");if(void 0!==e){var o;if("object"==typeof(o="object"==typeof e?e:this.byId(e))&&o.size()>0){if(n.removeClass("active"),o.addClass("active"),i)for(var a,s=o;(a=s.parents("li.aio-close")).size()>0;)a.children(".aio-expander").click();return this._typesHandler._doSwitchFolder(this,o),"function"!=typeof this.options.others.onSwitchFolder||!0===t||this.options.others.onSwitchFolder.bind(this.element)(o,"object"==typeof n?n.attr("data-aio-id"):void 0)}return!1}return n},loader:function(){return this._loaderHandler.fromArguments(arguments)},nodes:function(t){this._nodesLastEnabled=t,this._standardList.find("a").each(function(){t?e(this).attr("href",e(this).attr("data-aio-href")).removeClass("aio-disable-link"):(e(this).attr("data-aio-href",e(this).attr("href")).addClass("aio-disable-link"),e(this).attr("href","javascript:void(0)"))})},_nodesLastEnabled:!0,nodesHTML:function(e,t,i){var n=this._nodes.children("ul");if(0===n.size())throw"There is no <ul></ul> available in the .aio-nodes container!";var o=function(){var e=this.active();t&&(this.element.removeClass("aio-lazy"),this.loader(!1),void 0!==i?this.active(i,!0):e.size()>0&&this.active(e.attr("data-aio-id"),!0))}.bind(this);if(!e)return o(),n.html();n.data("nodesHTML",e),n.html(e),this.reinit(),o()},counts:function(t){if("object"==typeof t){var i;e.each(t,function(e,t){!1!==(i=this.byId(e))&&i.find(".aio-cnt").attr("class","aio-cnt aio-cnt-"+t).html(t)}.bind(this))}},byId:function(e){return void 0!==e&&this._standardList.find('a[data-aio-id="'+e+'"]')},rename:function(e,t){var i;if(1==arguments.length)i=this.active(),t=e;else{if(2!=arguments.length)return!1;i=e instanceof jQuery?e:this.byId(e)}if(i instanceof jQuery){i.children(".aio-node-name").html(t);var n=i.children("input");return n.size()>0&&n.val(t),!0}return!1},remove:function(e){var t;if((t=1==arguments.length&&"object"==typeof e?e instanceof jQuery?e:this.byId(e):this.active())instanceof jQuery){var i=t.parent(),n=i.parent().parent(),o=!1,a=this.active(),s=a.attr("data-aio-id");return a.size()>0&&s&&(a.is(t)?o=n.is("li")?n.children("a"):"firstNode":n.children("ul").find('a[data-aio-id="'+s+'"]').size()>0&&(o="firstNode")),i.remove(),"firstNode"===o&&(this._nodes.find("a").size()>0?o=this._nodes.find("a:first"):this._standardList.find("a").size()>0&&(o=this._standardList.find("a:first"))),o instanceof jQuery&&this.active(o),this.reinit("tree"),!0}return!1},serialize:function(){var e,t=this._nodes.children("ul"),i=this._toolbarHandler;if(t.size()>0){(e=t.data("nestedSortable"))||i._doPredefinedrearrangeActivate(t,this);var n=i._doPredefinedrearrangeParse(this,t);return e||t.nestedSortable("destroy"),n}return!1},breadcrumb:function(e){var t=this.active();if(t){var i=[],n=!t.parents(".aio-nodes").size()>0,o=function(e){for(;!1!==t;)(t=t.parent().parent().parent().children("a[data-aio-id]")).size()>0?e():t=!1};if("objects"===e){var a=function(e){return{id:e.attr("data-aio-id"),type:e.attr("data-aio-type"),name:e.children(".aio-node-name").html(),obj:e,link:e.attr("href")}};return i.push(a(t)),n||o(function(){i.push(a(t))}),i.reverse(),i}if(i.push(t.children(".aio-node-name").html()),n||o(function(){i.push(t.children(".aio-node-name").html())}),i.reverse(),!e||"array"===e)return n||i.unshift("/"),i;if("string"===e){var s=i.join("/");return n||(s="/"+s),s}}return""},_checkFolderContent:function(){this._nodes.find("li").size()>0?this.element.removeClass("aio-no-folders"):this.element.addClass("aio-no-folders")},_testLocalStorage:function(){try{window.localStorage.setItem("test","test"),window.localStorage.removeItem("test"),this._localStorage=!0}catch(e){}},_idGenerate:function(e){var t;if(e instanceof jQuery)return this._hasAttr("id",e)?e.attr("id"):(t=this._guid(),e.attr("id",t),t);var i=this.element;this._hasAttr("id")?t=i.attr("id"):(t=this._guid(),i.attr("id",t),this._generatedId=!0),this._id=t},_hasAttr:function(e,t){var i=(t instanceof jQuery?t:this.element).attr(e);return void 0!==i&&!1!==i},_parseElements:function(t,i){return"string"==typeof t?!0!==i?e(t):t:"function"==typeof t?t.bind(this.element)(jQuery):t instanceof jQuery&&!0!==i?t:void 0},_defined:function(e){return void 0!==e&&!1!==e&&null!==e},_isTouch:function(){var e="ontouchstart"in window||window.navigator.maxTouchPoints;return e?{touch:e,up:"touchend",down:"touchstart",move:"touchmove"}:{touch:e,up:"mouseup",down:"mousedown",move:"mousemove"}},_injectStyle:function(t,i){var n=this._id+"-style-"+t;return e("#"+n).remove(),e("<div />",{html:"&shy;<style>"+i+"</style>"}).attr("id",n).hide().appendTo("body")},_guid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"aio-"+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}};e.widget("mguenter.allInOneTree",r)}(jQuery);