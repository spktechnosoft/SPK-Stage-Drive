jQuery(document).ready(function(a){if(typeof wp=="undefined"||!wp.heartbeat){return}var b;a(".column-status").on("click","a.live-action",function(){if(a(this).hasClass("finish")&&!confirm(mymailL10n.finish_campaign)){return false}var c=a(this).parent().parent().parent().addClass("loading");a.get(a(this).attr("href"),function(){wp.heartbeat.connectNow()});return false});a(document).on("heartbeat-send",function(f,d){var c=[];a("tr.type-newsletter").each(function(){c.push(parseInt(a(this).find("input").eq(0).val(),10))});d.mymail={page:"overview",ids:c}}).on("heartbeat-tick",function(d,c){var f=false;if(c.mymail){if(!b){b=c.mymail;f=true}var g=false;a.each(c.mymail,function(i,e){var h=a("#post-"+i).removeClass("loading");if(!e){return}a.each(e,function(k,n){if(b&&b[i][k]==n){return}var m=b&&e.status!=b[i].status;switch(k){case"status":if(m){h.removeClass("status-"+b[i].status).addClass("status-"+e.status)}case"sent":case"total":case"sent_formatted":break;case"column-status":if(e.status=="active"&&!m){var j=h.find(".campaign-progress"),o=(e.sent/e.total*100);j.find(".bar").width(o+"%");j.find("span").eq(1).html(e.sent_formatted);j.find("var").html(Math.round(o)+"%");if(!f){break}}default:var l=h.find("."+k);if(!l.is(":visible")){break}l.fadeTo(10,0.01,function(){l.html(n).fadeTo(200,1)})}g=true})});if(g){wp.heartbeat.interval("fast")}b=c.mymail}});wp.heartbeat.interval("fast");if(wp.heartbeat.connectNow){wp.heartbeat.connectNow()}});