jQuery(document).ready(function(i){var k=i("#mymail_dashboard_nonce").val(),p=i(".mymail-db-campaings"),d=i(".mymail-db-subscribers"),r=i("#mymail-campaign-select"),j=i("#mymail-subscriber-range"),a=i("#subscriber-chart-wrap"),c=i("#subscriber-chart"),h=i("#mymail-chart-tooltip"),q=h.find("div"),m,l,n,f={responsive:true,animationEasing:"easeOutExpo",maintainAspectRatio:false,tooltipTemplate:"<%= value  %>",scaleLabel:"<%= (value >= 1000) ? (value/1000).toFixed(1)+'K' : value + ''%>",customTooltips:function(t,s,u){if(!t){h.removeClass("is-visible");return}q.html(t.text+" Subscribers");h.addClass("is-visible");h.css({top:t.y-(h.outerHeight())+15,left:t.x-(h.outerWidth()/2)+10})}};if(c.length){n=c[0].getContext("2d")}r.on("change",function(){g(i(this).val())}).trigger("change");j.on("change",function(){o()}).trigger("change");i(".piechart").easyPieChart({animate:1000,rotate:180,barColor:"#2BB3E7",trackColor:"#f3f3f3",lineWidth:9,size:75,lineCap:"square",onStep:function(s){this.$el.find("span").text(Math.round(s))},onStop:function(s){this.$el.find("span").text(Math.round(s))}});if(typeof wp!="undefined"&&wp.heartbeat){i(document).on("heartbeat-send",function(t,s){g(l,true)})}function o(t,v,s,u){d.addClass("loading");b("get_dashboard_chart",{range:j.val()},function(w){e();d.removeClass("loading");if(!m){m=new Chart(n)}m.Line(w.chart,f)})}function e(){m=null;if(c){c.remove()}c=i("<canvas>").prependTo(a);n=c[0].getContext("2d");c.attr({width:a.width(),height:a.height()})}function g(s,t){if(!t){p.addClass("loading")}b("get_dashboard_camp",{id:s},function(u){var v=u.camp;l=v.ID;i("#camp_name").html(v.name).attr("href","post.php?post="+v.ID+"&action=edit").removeAttr("class");(v.active)?i("#camp_name").addClass("status-active"):i("#camp_name").addClass("status-finished");i("#stats_total").html(v.sent);i("#stats_open").data("easyPieChart").update(v.openrate*100);i("#stats_clicks").data("easyPieChart").update(v.clickrate*100);i("#stats_unsubscribes").data("easyPieChart").update(v.unsubscriberate*100);i("#stats_bounces").data("easyPieChart").update(v.bouncerate*100);p.removeClass("loading")})}function b(v,u,w,t,s){if(i.isFunction(u)){if(i.isFunction(w)){t=w}w=u;u={}}i.ajax({type:"POST",url:ajaxurl,data:i.extend({action:"mymail_"+v,_wpnonce:k},u),success:function(y,z,x){w&&w.call(this,y,z,x)},error:function(x,z,y){if(z=="error"&&!y){return}if(console){console.error(i.trim(x.responseText))}t&&t.call(this,x,z,y)},dataType:s?s:"JSON"})}});