var usinModuleApp=angular.module("usinModuleApp",[],["$httpProvider",function(a){a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",a.defaults.transformRequest=[function(a){return angular.isObject(a)&&"[object File]"!==String(a)?usinHelpers.serializeObject(a):a}]}]).value("options",{}).run(["options",function(a){var b=window.USIN;a.viewsURL=b.viewsURL,a.ajaxURL=b.ajaxURL,a.nonce=b.nonce,a.modules=b.modules,a.strings=b.strings}]);usinModuleApp.filter("moduleActive",function(){return function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)a[d].active===b&&c.push(a[d]);return c}}),usinModuleApp.controller("UsinMainCtrl",["$scope","options",function(a,b){a.modules=b.modules,a.strings=b.strings,a.getModule=function(b){for(var c=0,d=a.modules.length;d>c;c++)if(a.modules[c].id==b)return a.modules[c]}}]).controller("UsinModuleCtrl",["$scope","options","UsinModuleQuery","$window",function(a,b,c,d){var e=a.module;a.moduleLoading=!1,a.setStatusEdit=function(){e.status="edit"},a.setStatusDefault=function(){e.status="default"},a.onActivateClick=function(){var b=!1;if((e.requires_license&&!e.uses_module_license&&e.options.license.activated||!e.requires_license)&&(b=!0),e.uses_module_license){var g=a.getModule(e.uses_module_license);g&&g.options.license.activated&&(b=!0)}b?(a.moduleError="",a.moduleLoading=!0,c.activateModule(e.id).then(function(){var a=usinHelpers.url.addParam(d.location.href,"usin_module_activated",e.id);d.location.href=a},f)["finally"](function(){a.moduleLoading=!1})):a.setStatusEdit()},a.onDeactivateClick=function(){a.moduleLoading=!0,c.deactivateModule(e.id).then(function(){d.location.reload()},f)["finally"](function(){a.moduleLoading=!1})};var f=function(b){a.moduleError=b.data&&b.data.error||a.strings.errorRequest}}]).controller("UsinLicenseCtrl",["$scope","UsinModuleQuery",function(a,b){a.successMsg="",a.errorMsg="",a.licenseLoading=!1,a.licenseSet=function(){return a.module.options.license.activated},a.addLicense=function(){var e=a.module.options.license.key;e&&(a.licenseLoading=!0,b.addLicense(a.module.id,e).then(function(b){d(a.strings.licenseActivated),a.module.options=b.data},c)["finally"](function(){a.licenseLoading=!1}))},a.deactivateLicense=function(){var e=a.module.options.license.key;a.licenseLoading=!0,b.deactivateLicense(a.module.id,e).then(function(b){d(a.strings.licenseDeactivated),a.module.options=b.data},c)["finally"](function(){a.licenseLoading=!1})},a.refreshLicense=function(){a.licenseLoading=!0,b.refreshLicenseStatus(a.module.id).then(function(b){d(""),a.module.options=b.data},c)["finally"](function(){a.licenseLoading=!1})};var c=function(b){a.errorMsg=b.data&&b.data.error||a.strings.errorRequest,a.successMsg=""},d=function(b){a.successMsg=b,a.errorMsg=""}}]),usinModuleApp.directive("usinMain",["options",function(a){return{restrict:"EAC",templateUrl:a.viewsURL+"/main.html",controller:"UsinMainCtrl"}}]).directive("usinModule",["options",function(a){return{restrict:"EAC",templateUrl:a.viewsURL+"/module.html",controller:"UsinModuleCtrl"}}]).directive("usinLicense",["options",function(a){return{restrict:"EAC",templateUrl:a.viewsURL+"/license.html",controller:"UsinLicenseCtrl"}}]),usinModuleApp.factory("UsinModuleQuery",["options","$http",function(a,b){return{addLicense:function(c,d){var e=usinHelpers.url.addParam(a.ajaxURL,"action","usin_add_license"),f={module_id:c,license_key:d,nonce:a.nonce};return b({method:"post",url:e,data:f})},deactivateLicense:function(c,d){var e=usinHelpers.url.addParam(a.ajaxURL,"action","usin_deactivate_license"),f={module_id:c,license_key:d,nonce:a.nonce};return b({method:"post",url:e,data:f})},activateModule:function(c){var d=usinHelpers.url.addParam(a.ajaxURL,"action","usin_activate_module"),e={module_id:c,nonce:a.nonce};return b({method:"post",url:d,data:e})},deactivateModule:function(c){var d=usinHelpers.url.addParam(a.ajaxURL,"action","usin_deactivate_module"),e={module_id:c,nonce:a.nonce};return b({method:"post",url:d,data:e})},refreshLicenseStatus:function(c){var d=usinHelpers.url.addParam(a.ajaxURL,"action","usin_refresh_license_status"),e={module_id:c,nonce:a.nonce};return b({method:"post",url:d,data:e})}}}]);
//# sourceMappingURL=modules.min.js.map